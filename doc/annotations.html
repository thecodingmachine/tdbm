<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#" class="no-js">
<head>
    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

    <title>Annotations | TDBM</title>

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

    <link rel="apple-touch-icon" sizes="57x57" href="/dist/img/favicon/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/dist/img/favicon/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/dist/img/favicon/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/dist/img/favicon/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/dist/img/favicon/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/dist/img/favicon/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/dist/img/favicon/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/dist/img/favicon/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/dist/img/favicon/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/dist/img/favicon/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/dist/img/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/dist/img/favicon/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/dist/img/favicon/favicon-16x16.png">

    <link href="//fonts.googleapis.com/css?family=Roboto:400,700,300,500" rel="stylesheet" type="text/css">

    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/dist/img/favicon/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <meta name="msapplication-TileColor" content="#f01d4f">
    <meta name="msapplication-TileImage" content="//www.thecodingmachine.com/wp-content/themes/thecodingmachine/library/images/win8-tile-icon.png">

    <script>
        window.resourceBaseUrl = 'https://thecodingmachine.github.io/tdbm';
    </script>

    <style>
        /** quick fix because bootstrap <pre> has a background-color. */
        pre code { background-color: inherit; }
    </style>

    <link rel="stylesheet" type="text/css" href="https://thecodingmachine.github.io/tdbm/assets/main.css">
                

    <link rel='stylesheet' id='font-awesome-css'  href='//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css' type='text/css' media='all' />
    <link rel='stylesheet' id='google-roboto-css'  href='//fonts.googleapis.com/css?family=Roboto%3A100%2C400%2C300%2C400italic%2C500%2C700' type='text/css' media='all' />

    <style>
        pre.hljs {padding: 5px;}
        pre.hljs code {}
            </style>
        <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-10196481-4', 'auto');
        ga('send', 'pageview');

    </script>
    </head>
<body class="">

<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div >
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <img class="img-responsive" src="https://thecodingmachine.github.io/tdbm/doc/images/logo.png" alt="" style="position: absolute;">
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav text-left">
                <li><a href="https://thecodingmachine.github.io/tdbm/">ABOUT</a></li>
                                                            <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/index.html">
                                Introduction
                            </a>
                        </li>
                                                                                                                    <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/install.html">
                                Installing TDBM
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/install_laravel.html">
                                Install in Laravel
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/install_lumen.html">
                                Install in Lumen
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/install_symfony.html">
                                Install in Symfony
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/install_silex.html">
                                Install in Silex
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/install_mouf.html">
                                Install in Mouf
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/manual_install.html">
                                Manual install
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/install_service-provider.html">
                                Install with container-interop/service-provider
                            </a>
                        </li>
                                                                                                                    <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/quickstart.html">
                                Getting started
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/limit_offset_resultset.html">
                                Playing with result sets
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/generating_daos.html">
                                About DAOs
                            </a>
                        </li>
                                                                                                                    <li class="active visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/annotations.html">
                                Annotations
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/advanced.html">
                                Advanced filtering
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/modeling_inheritance.html">
                                Modeling inheritance
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/json_serialization.html">
                                JSON serialization
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/miscellaneous.html">
                                Miscellaneous features
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/memory_management.html">
                                Memory management and batches processing
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/configuring_naming.html">
                                Configuring naming of beans and DAOs
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/comparison_with_doctrine.html">
                                A quick comparison with Doctrine
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/migrating.html">
                                Migrating
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/compatibility.html">
                                Databases compatibility
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/internals.html">
                                TDBM internals
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/customizing_code_generation.html">
                                Customizing code generation
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/faq.html">
                                Frequently asked questions
                            </a>
                        </li>
                                                                                                                    <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/fluid_schema_builder.html">
                                Fluid schema builder
                            </a>
                        </li>
                                                                                <li class=" visible-xs-block">
                            <a href="https://thecodingmachine.github.io/tdbm/doc/graphqlite.html">
                                GraphQLite
                            </a>
                        </li>
                                                    <li><a href="http://www.thecodingmachine.com/">TheCodingMachine</a></li>
                                <li><a href="https://github.com/thecodingmachine/tdbm"><img src="https://thecodingmachine.github.io/tdbm/img/GitHub-Mark-Light-20px.png" /> Github</a></li>
                            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

<!-- Full Width Image Header with Logo -->
<!-- Image backgrounds are set within the full-width-pics.css file. -->
<div id="wrapper">
    <a href="#menu-toggle" class="burger-position" id="menu-toggle" ><img src="https://thecodingmachine.github.io/tdbm/doc/images/hamburger.png"> </a>
    <!-- Sidebar -->
    <div id="sidebar-wrapper">
        <ul class="sidebar-nav">
                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/index.html">
                            Introduction
                        </a>
                    </li>
                                                                <li>
                        <h4>Installation</h4>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/install.html">
                            Installing TDBM
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/install_laravel.html">
                            Install in Laravel
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/install_lumen.html">
                            Install in Lumen
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/install_symfony.html">
                            Install in Symfony
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/install_silex.html">
                            Install in Silex
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/install_mouf.html">
                            Install in Mouf
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/manual_install.html">
                            Manual install
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/install_service-provider.html">
                            Install with container-interop/service-provider
                        </a>
                    </li>
                                                                <li>
                        <h4>Basics</h4>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/quickstart.html">
                            Getting started
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/limit_offset_resultset.html">
                            Playing with result sets
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/generating_daos.html">
                            About DAOs
                        </a>
                    </li>
                                                                <li>
                        <h4>Advanced</h4>
                    </li>
                                                                <li class="active">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/annotations.html">
                            Annotations
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/advanced.html">
                            Advanced filtering
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/modeling_inheritance.html">
                            Modeling inheritance
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/json_serialization.html">
                            JSON serialization
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/miscellaneous.html">
                            Miscellaneous features
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/memory_management.html">
                            Memory management and batches processing
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/configuring_naming.html">
                            Configuring naming of beans and DAOs
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/comparison_with_doctrine.html">
                            A quick comparison with Doctrine
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/migrating.html">
                            Migrating
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/compatibility.html">
                            Databases compatibility
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/internals.html">
                            TDBM internals
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/customizing_code_generation.html">
                            Customizing code generation
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/faq.html">
                            Frequently asked questions
                        </a>
                    </li>
                                                                <li>
                        <h4>Integrations and extensions</h4>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/fluid_schema_builder.html">
                            Fluid schema builder
                        </a>
                    </li>
                                                                <li class="">
                        <a href="https://thecodingmachine.github.io/tdbm/doc/graphqlite.html">
                            GraphQLite
                        </a>
                    </li>
                                    </ul>
    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">
        <header class="image-bg-fluid-height skew">
            <div class="wrapper content">
                <!-- /
              <h4 class="glitch">DISCOVERY</h4>
               -->
            </div>

        </header>
        <div class="container pt100">
            <div class="row">
                <div class="col-xs-12">
                    <h1>Annotations <small></small></h1>                    <p>TDBM can read annotations to alter the generation of beans and DAOs.</p>
<p>If you have used annotations in the past, you are probably used to put annotations in your PHP documentation blocks.
But TDBM being a database-driven ORM, everything starts from the database. So TDBM will actually read annotations... from your database comments!</p>
<h2 id="the-uuid-annotation">The @UUID annotation</h2>
<p>By adding a <code>@UUID</code> annotation in your column comment, you inform TDBM that the column contains a generated random <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_1_.28date-time_and_MAC_address.29">UUID</a> value.</p>
<p>On object instantiation, TDBM will automatically fill the column with a random UUID. You would typically use this annotation in a primary key column.</p>
<pre><code class="language-sql">CREATE TABLE `articles` (
  `id` varchar(36) NOT NULL COMMENT '@UUID',
  `content` varchar(255),
  PRIMARY KEY (`id`)
);</code></pre>
<p>This will generate a bean with the following code:</p>
<pre><code class="language-php">use Ramsey\Uuid\Uuid;

abstract class AbstractArticle extends AbstractTDBMObject implements \JsonSerializable
{
    public function __construct()
    {
        parent::__construct();
        $this-&gt;setId(Uuid::uuid1());
    }
    // ...
}</code></pre>
<h3 id="choosing-the-uuid-version">Choosing the UUID version</h3>
<p>By default, <strong>UUID v1</strong> is used. UUID v1 is timestamp-based. Therefore, your database rows will be sorted according to the creation order (just like with an autoincremented ID).</p>
<p>However, this also means that your ID contains the creation timestamp of the field. If this is a sensitive information that you want to hide, you can instead use UUID v4.</p>
<p>To do so, simply use the <code>@UUID("v4")</code> annotation like this:</p>
<pre><code class="language-sql">CREATE TABLE `articles` (
  `id` varchar(36) NOT NULL COMMENT '@UUID("v4")',
  `content` varchar(255),
  PRIMARY KEY (`id`)
);</code></pre>
<h2 id="the-autoincrement-annotation">The @Autoincrement annotation</h2>
<div class="alert alert-danger">The @Autoincrement annotation is mostly useful with Oracle databases</div>
<p><strong>You won't need this annotation if you are using MySQL or PostgreSQL.</strong></p>
<p>On some database platforms (namely <em>Oracle</em>), there is no native support for auto-incremented IDs. However, these can be &quot;emulated&quot; using a database trigger and a sequence.</p>
<p>However, when TDBM will read the model, it will not be able to understand that your column is auto-incremented via a trigger. So you have to tell TDBM that your column is auto-incremented manually. You do this by adding the <code>@Autoincrement</code> comment in the column description.</p>
<pre><code class="language-sql">CREATE TABLE departments (
  ID           NUMBER(10)    NOT NULL COMMENT '@Autoincrement',
  DESCRIPTION  VARCHAR2(50)  NOT NULL);

ALTER TABLE departments ADD (
  CONSTRAINT dept_pk PRIMARY KEY (ID));

CREATE SEQUENCE dept_seq START WITH 1;

CREATE OR REPLACE TRIGGER dept_bir 
BEFORE INSERT ON departments 
FOR EACH ROW

BEGIN
  SELECT dept_seq.NEXTVAL
  INTO   :new.id
  FROM   dual;
END;
/</code></pre>
<h2 id="the-bean-annotation">The @Bean annotation</h2>
<p><small>(Available in TDBM 5.1+)</small></p>
<p>This annotation can be put on a table comment to alter the name of the generated bean.</p>
<pre><code class="language-sql">CREATE TABLE `members` (
  `id` varchar(36) NOT NULL,
  `login` varchar(50),
  PRIMARY KEY (`id`)
) COMMENT("@Bean(name=\"User\")");</code></pre>
<p>In the example above, the bean class name will not be <code>Member</code> but <code>User</code>.
The name of the DAO will also be changed from <code>MemberDao</code> to <code>UserDao</code>.</p>
<div class="alert alert-info">Note: the @Bean annotation is read by the <a href="configuring_naming.md">default naming strategy</a> provided by TDBM.
If you use your own naming strategy, the @Bean annotation will be ignored unless you explicitly code it back in your
naming strategy.</div>
<h2 id="the-protectedgetter-and-protectedsetter-annotations">The @ProtectedGetter and @ProtectedSetter annotations</h2>
<p><small>(Available in TDBM 5.1+)</small></p>
<p>These annotations can be put on a column comment to alter the visibility of the generated getter.</p>
<pre><code class="language-sql">CREATE TABLE `users` (
  `id` INTEGER NOT NULL,
  `login` varchar(255),
  `password` varchar(255) COMMENT '@ProtectedGetter',
  `status` INTEGER COMMENT '@ProtectedSetter',
  PRIMARY KEY (`id`)
);</code></pre>
<p>In the example above, the <code>getPassword</code> method and the <code>setStatus</code> method will be protected.</p>
<p>Use the <code>@ProtectedGetter</code> and <code>@ProtectedSetter</code> if you want to avoid an &quot;anemic&quot; data model.</p>
<p>The getters and the setters are only available from the class itself and you can instead add methods more
&quot;domain-oriented&quot;.</p>
<p>For instance:</p>
<pre><code class="language-php">class User extends AbstractUser
{
    public function enableUser(): void {
        $this-&gt;setStatus(1);
    }

    public function disableUser(): void {
        $this-&gt;setStatus(0);
    }

    public function setPassword(string $password): void {
        parent::setPassword(password_hash($password, PASSWORD_DEFAULT));
    }

    public function verifyPassword(string $password): bool {
        return password_verify($password, $this-&gt;getPassword());
    }

}</code></pre>
<p>Hiding the getter and setter makes your bean more reliable and easier to use.</p>
<p>By hiding <code>setStatus</code> and replacing it with <code>enableUser/disableUser</code>, you make sue
that the developer using the User bean cannot set an invalid status.</p>
<p>Making the <code>getPassword</code> method protected, you cannot even get the hashed password from the bean, only verify it.</p>
<p>Notice: a complete implementation should also check if a password needs rehashing but this is going beyond the scope of this simple example.</p>
<div class="alert alert-info">When you use the `@ProtectedGetter` annotation, TDBM will assume the column
access is sensitive and will therefore prevent the column from being JSON serialized.</div>
<h2 id="the-protectedonetomany-annotation">The @ProtectedOneToMany annotation</h2>
<p><small>(Available in TDBM 5.1+)</small></p>
<p>This annotation can be put on a column comment to alter the visibility of the &quot;inverse&quot; relationship.</p>
<p>For instance, if you put the <code>@ProtectedOneToMany</code> on the &quot;country_id&quot; column of a &quot;users&quot; table,
then in the <code>Country</code> bean, the <code>getUsers()</code> method will be protected.</p>
<h2 id="the-readonly-annotation">The @ReadOnly annotation</h2>
<p><small>(Available in TDBM 5.2+)</small></p>
<p>Columns with the &quot;@ReadOnly&quot; annotation cannot be written at all by TDBM.</p>
<p>Add this annotation to any column that is generated/computed in your database.</p>
<p>For instance:</p>
<pre><code class="language-sql">CREATE TABLE `products` (
    `id` INT UNSIGNED AUTO_INCREMENT NOT NULL,
    `data` JSON NOT NULL,
    `names_virtual` VARCHAR(20) GENERATED ALWAYS AS (`data` -&gt;&gt; '$.name') NOT NULL COMMENT '@ReadOnly', 
    PRIMARY KEY (`id`)
)</code></pre>
<p>Note: TDBM is based in Doctrine DBAL and Doctrine DBAL offers no way of knowing which columns are computed. So each time
you have a generated column in your data model, you will need to put the <code>@ReadOnly</code> annotation explicitly. </p>
<h2 id="the-json-annotations">The @Json annotations</h2>
<p>The <code>@Json</code> set of annotations helps monitoring the generation of <code>jsonSerialize</code> method.</p>
<h3 id="jsonkey">@JsonKey:</h3>
<p>Use the <code>@JsonKey</code> annotation to change the name of the serialized property. It works with a scalar column, a direct
foreign key and even a pivot table.</p>
<h3 id="jsonformat">@JsonFormat:</h3>
<p>Use the <code>@JsonFormat</code> annotation to specify format to use when serializing.
Depending on the type of the property, the arguments are:</p>
<ul>
<li>Datetime: <code>datetime=&lt;string&gt;</code> a format compatible with <code>date</code> function.</li>
<li>int/float: <code>decimals=&lt;int&gt;</code>, <code>point=&lt;string&gt;</code>, <code>separator=&lt;string&gt;</code>, <code>unit=&lt;string&gt;</code> the 3 first arguments are then
passed to function <code>number_format</code>. An additional argument <code>unit</code> may be useful to suffix the property value.</li>
<li>object: <code>method=&lt;string&gt;</code> or <code>property=&lt;string&gt;</code> a method or a property accessible with a standard getter.</li>
</ul>
<h3 id="jsonignore">@JsonIgnore:</h3>
<p>Use the <code>@JsonIgnore</code> annotation if you want to hide a property when serializing a bean. You may use it to hide scalar
or referenced objects, whether from direct foreign key or from a pivot table. In order to do so, you need to annotate
one of the foreign key columns.</p>
<h3 id="jsoninclude">@JsonInclude:</h3>
<p>Use the <code>@JsonInclude</code> annotation to ignore parameter <code>$stopRecursion</code> in <code>jsonSerialize</code>, therefore treating sub-object
almost like a scalar. If used on a pivot table, the reciprocal will be ignored (implicit <code>@JsonIgnore</code> on secondary
foreign key).</p>
<h3 id="jsonrecursive">@JsonRecursive:</h3>
<p>Use the <code>@JsonRecursive</code> annotation to set parameter <code>$stopRecursion</code> to <code>true</code> when calling <code>jsonSerialize</code> on
sub-object. Likewise <code>@JsonInclude</code>, the reciprocal will be ignored when used on a pivot table.</p>
<h3 id="jsoncollection">@JsonCollection:</h3>
<p>Use the <code>@JsonCollection</code> annotation on a foreign key to invert the serialization, from one-to-one to one-to-many. You
may provide the collection property name in json using argument <code>key=&lt;string&gt;</code>.
Moreover, the <code>@JsonCollection</code> annotation is compatible with <code>@JsonFormat</code>, <code>@JsonRecursive</code> and <code>@JsonInclude</code>.</p>
<p>Here is an example of a schema using massive @Json annotations to customize code generation:</p>
<pre><code class="language-sql">CREATE TABLE `accounts` (
  `id` INTEGER NOT NULL,
  `name` VARCHAR(255),
  PRIMARY KEY (`id`)
);

CREATE TABLE `nodes` (
  `id` INTEGER NOT NULL COMMENT '@JsonIgnore',
  `alias_id` INTEGER COMMENT '@JsonRecursive',
  `parent_id` INTEGER COMMENT '@JsonInclude',
  `root_id` INTEGER COMMENT '@JsonIgnore',
  `owner_id` INTEGER COMMENT '@JsonFormat(property="name") @JsonInclude',
  `name` VARCHAR(255) COMMENT '@JsonKey("basename")',
  `size` INTEGER COMMENT '@JsonFormat(unit=" ko")',
  `weight` FLOAT COMMENT '@JsonFormat(decimals=2,unit="g")',
  `created_at` DATE COMMENT '@JsonFormat("Y-m-d")',
  FOREIGN KEY fk_alias(`alias_id`)
    REFERENCES nodes(`id`),
  FOREIGN KEY fk_parent(`parent_id`)
    REFERENCES nodes(`id`),
  FOREIGN KEY fk_root(`root_id`)
    REFERENCES nodes(`id`),
  FOREIGN KEY fk_owner(`owner_id`)
    REFERENCES accounts(`id`),
  PRIMARY KEY (`id`)
);

CREATE TABLE `nodes_guests` (
  `node_id` INTEGER NOT NULL COMMENT '@JsonIgnore',
  `guest_id` INTEGER NOT NULL COMMENT '@JsonKey("guests") @JsonFormat(method="getName")',
  FOREIGN KEY fk_node(`node_id`)
    REFERENCES nodes(`id`),
  FOREIGN KEY fk_guest(`guest_id`)
    REFERENCES accounts(`id`)
);

CREATE TABLE `node_entries` (
  `id` INTEGER NOT NULL,
  `node_id` INTEGER NOT NULL COMMENT '@JsonCollection("entries") @JsonFormat(property="entry")',
  `entry` VARCHAR(255),
  FOREIGN KEY fk_node(`node_id`)
    REFERENCES nodes(`id`),
  PRIMARY KEY (`id`)
);</code></pre>
<p>With such a configuration: a serialized <code>NodeBean</code> looks like this:</p>
<pre><code class="language-json">{
  "alias": null,
  "parent": {
    "parent": {
      "parent": {
        "parent": null,
        "owner": "root",
        "basename": "\/",
        "size": "0 o",
        "weight": null,
        "createdAt": "2018-04-18"
      },
      "owner": null,
      "basename": "var",
      "size": "0 o",
      "weight": null,
      "createdAt": "2018-04-18"
    },
    "owner": null,
    "basename": "www",
    "size": "0 o",
    "weight": null,
    "createdAt": "2019-04-08"
  },
  "owner": "user",
  "basename": "index.html",
  "size": "512 o",
  "weight": "42.50g",
  "createdAt": "2019-04-18",
  "entries": [
    "&lt;h1&gt;",
    "Hello, World",
    "&lt;\/h1&gt;"
  ],
  "guests": [
    "root",
    "www"
  ]
}</code></pre>
<p>Or:</p>
<pre><code class="language-json">{
  "alias": {
    "alias": null,
    "parent": {
      "parent": {
        "parent": null,
        "owner": "root",
        "basename": "\/",
        "size": "0 o",
        "weight": null,
        "createdAt": "2018-04-18"
      },
      "owner": null,
      "basename": "private",
      "size": "0 o",
      "weight": null,
      "createdAt": "2018-04-18"
    },
    "owner": null,
    "basename": "var",
    "size": "0 o",
    "weight": null,
    "createdAt": "2018-04-18",
    "entries": [],
    "guests": []
  },
  "parent": {
    "parent": null,
    "owner": "root",
    "basename": "\/",
    "size": "0 o",
    "weight": null,
    "createdAt": "2018-04-18"
  },
  "owner": null,
  "basename": "var",
  "size": "0 o",
  "weight": null,
  "createdAt": "2018-04-18",
  "entries": [],
  "guests": []
}</code></pre>
<p>A <code>AccountBean</code>:</p>
<pre><code class="language-json">{
  "id": 1,
  "name": "user"
}</code></pre>
<p>And, at last, a <code>NodeEntryBean</code>:</p>
<pre><code class="language-json">{
  "id": 2,
  "node": {
    "parent": {
      "parent": {
        "parent": {
          "parent": null,
          "owner": "root",
          "basename": "\/",
          "size": "0 o",
          "weight": null,
          "createdAt": "2018-04-18"
        },
        "owner": null,
        "basename": "var",
        "size": "0 o",
        "weight": null,
        "createdAt": "2018-04-18"
      },
      "owner": null,
      "basename": "www",
      "size": "0 o",
      "weight": null,
      "createdAt": "2019-04-08"
    },
    "owner": "user",
    "basename": "index.html",
    "size": "512 o",
    "weight": "42.50g",
    "createdAt": "2019-04-18"
  },
  "entry": "Hello, World"
}</code></pre>
<h2 id="the-addinterface-annotation">The @AddInterface annotation</h2>
<p><small>(Available in TDBM 5.1+)</small></p>
<div class="alert alert-warning">Until <a href="https://github.com/doctrine/dbal/pull/3512" target="_blank">this PR is merged in Doctrine DBAL</a>, this annotation will only work on MySQL databases.</div>
<p>Use this annotation in a table comment to force a bean to implement a given PHP interface.</p>
<pre><code class="language-sql">CREATE TABLE `members` (
  `id` varchar(36) NOT NULL,
  `login` varchar(50),
  PRIMARY KEY (`id`)
) COMMENT("@AddInterface(\"App\\MemberInterface\")");</code></pre>
<p>Why this annotation?</p>
<p>If you are developing an application, it is likely you will not need this annotation. You can simply edit your bean
and add an <code>implements</code> clause in the class declaration.</p>
<p>However, if you are developing a library meant to be used by other developers, you can provide a SQL patch that will
alter the comments of the table. The <code>implements</code> clause will be added by TDBM on the base bean class automatically.
Therefore, this annotation allows third party-libraries to add interfaces to your beans.</p>
<p>This annotation is particularly powerful when used in conjunction with the <code>@AddTrait</code> annotation.</p>
<h2 id="the-addinterfaceondao-annotation">The @AddInterfaceOnDao annotation</h2>
<p><small>(Available in TDBM 5.1+)</small></p>
<div class="alert alert-warning">Until <a href="https://github.com/doctrine/dbal/pull/3512" target="_blank">this PR is merged in Doctrine DBAL</a>, this annotation will only work on MySQL databases.</div>
<p>This annotation is similar to the <code>@AddInterface</code> annotation but it adds the interface on the DAO instead of the Bean.
Use this annotation in a table comment to force a DAO to implement a given PHP interface.</p>
<pre><code class="language-sql">CREATE TABLE `members` (
  `id` varchar(36) NOT NULL,
  `login` varchar(50),
  PRIMARY KEY (`id`)
) COMMENT("@AddInterfaceDao(\"App\\MemberDaoInterface\")");</code></pre>
<h2 id="the-addtrait-annotation">The @AddTrait annotation</h2>
<p><small>(Available in TDBM 5.1+)</small></p>
<div class="alert alert-warning">Until <a href="https://github.com/doctrine/dbal/pull/3512" target="_blank">this PR is merged in Doctrine DBAL</a>, this annotation will only work on MySQL databases.</div>
<p>Use this annotation in a table comment to force a bean to use a given PHP trait.</p>
<pre><code class="language-sql">CREATE TABLE `members` (
  `id` varchar(36) NOT NULL,
  `login` varchar(50),
  PRIMARY KEY (`id`)
) COMMENT("@AddTrait(\"App\\MemberTrait\")");</code></pre>
<p>This annotation is very useful to third party libraries that provide a table and want to ship a default behaviour for the beans
associated with the table.</p>
<p>You can also use the &quot;modifiers&quot; attribute of the annotation to override or alias some methods of the traits:</p>
<pre><code class="language-sql">CREATE TABLE `members` (
  `id` varchar(36) NOT NULL,
  `login` varchar(50),
  PRIMARY KEY (`id`)
) COMMENT("@AddTrait(name=\"App\\MemberTrait\"
           modifiers={\"\\App\\MemberTrait::myMethod insteadof OtherTrait\",
                      \"\\App\\OtherTrait::myMethod as myRenamedMethod\"}
           )");</code></pre>
<h2 id="the-addtraitondao-annotation">The @AddTraitOnDao annotation</h2>
<p><small>(Available in TDBM 5.1+)</small></p>
<div class="alert alert-warning">Until <a href="https://github.com/doctrine/dbal/pull/3512" target="_blank">this PR is merged in Doctrine DBAL</a>, this annotation will only work on MySQL databases.</div>
<p>This annotation is similar to the <code>@AddTrait</code> annotation but it adds the trait on the DAO instead of the Bean.</p>
<pre><code class="language-sql">CREATE TABLE `members` (
  `id` varchar(36) NOT NULL,
  `login` varchar(50),
  PRIMARY KEY (`id`)
) COMMENT("@AddTraitOnDao(\"App\\MemberDaoTrait\")");</code></pre>

                    <p class="fork-and-edit">
                        Found a typo? Something is wrong in this documentation? Just
                        <a href="https://github.com/thecodingmachine/tdbm/blob/master/doc/annotations.md">fork and edit it</a>!
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- /#page-content-wrapper -->

</div>
<div class="footer">
    <div class="container-fluid">
        <footer class="row" id="footer">
            <div class="col-xs-12">
                Made with <span class="pulse2 glyphicon glyphicon-heart" style="color: red" aria-hidden="true"></span><span class="sr-only">love</span> by <a href="https://www.thecodingmachine.com/"><img src="https://thecodingmachine.github.io/tdbm/img/logo.png" alt="TheCodingMachine"></a> for all open-source lovers
                <span class="copyright">&copy; 2016 - 2025 <a href="https://www.thecodingmachine.com/">TheCodingMachine</a> - All Rights Reserved</span>
                Powered by <a href="http://couscous.io/">Couscous</a></span>
            </div>
        </footer>
    </div>
</div>

<!-- /#wrapper -->
<script type='text/javascript' src='https://thecodingmachine.github.io/tdbm/assets/app.bundle.js'></script>
<script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
</script>
</body>
</html>
